{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.11", "generated_at": "2024-05-02T18:00:21.063196Z", "invocation_id": "789b99f8-c265-40ea-8d01-0faa12b0e639", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-02T18:00:18.650235Z", "completed_at": "2024-05-02T18:00:18.661107Z"}, {"name": "execute", "started_at": "2024-05-02T18:00:18.661833Z", "completed_at": "2024-05-02T18:00:19.736130Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0880210399627686, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "personal-pgatour", "job_id": "b8bb0046-99a8-4fe1-83b2-360e38fcea7c", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_pgatour.tournament_leaderboard_round_position", "compiled": true, "compiled_code": "\n\nWITH cte_leaderboard_round AS\n  (\n   SELECT\n        DISTINCT PlayerRoundID\n       ,RoundNumber\n       ,BackNineStart\n       ,PlayerID\n       ,TournamentID\n       ,PlayerTournamentID\n   FROM `personal-pgatour`.`tournament_leaderboard`.`leaderboard_round_stats`\n  )\n,\ncte_leaderboard_hole AS\n(\n SELECT\n     DISTINCT PlayerRoundID\n    ,HoleNumber\n    ,Par\n    ,ToPar\n    ,Strokes\n    ,ToParOnRound\n    ,StrokesOnRound\n FROM `personal-pgatour`.`tournament_leaderboard`.`leaderboard_hole_stats`\n)\n\nSELECT\n     rnd.PlayerRoundID\n    ,rnd.RoundNumber\n    ,hole.HoleNumber\n    ,hole.Par\n    ,hole.ToPar\n    ,hole.Strokes\n    ,hole.ToParOnRound\n    ,hole.StrokesOnRound\n    ,rnd.BackNineStart\n    ,rnd.PlayerID\n    ,rnd.TournamentID\n    ,rnd.PlayerTournamentID\n    ,RANK() OVER (\n        PARTITION BY rnd.TournamentID, rnd.RoundNumber, hole.HoleNumber\n        ORDER BY hole.ToParOnRound ASC\n        ) AS LeaderboardPositionOnRound_ToPar\n    ,RANK() OVER (\n        PARTITION BY rnd.TournamentID, rnd.RoundNumber, hole.HoleNumber\n        ORDER BY hole.StrokesOnRound ASC\n        ) AS LeaderboardPositionOnRound_Strokes\nFROM cte_leaderboard_round  rnd\nJOIN cte_leaderboard_hole   hole\nON  rnd.PlayerRoundID = hole.PlayerRoundID\n\nORDER BY\n     rnd.TournamentID\n    ,rnd.PlayerTournamentID\n    ,rnd.RoundNumber\n    ,hole.HoleNumber", "relation_name": "`personal-pgatour`.`tournament_leaderboard`.`tournament_leaderboard_round_position`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-02T18:00:19.739157Z", "completed_at": "2024-05-02T18:00:19.743488Z"}, {"name": "execute", "started_at": "2024-05-02T18:00:19.743948Z", "completed_at": "2024-05-02T18:00:21.056013Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3189809322357178, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "personal-pgatour", "job_id": "d500d8b7-181b-477e-8ec0-4d0b6b54ae02", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_pgatour.tournament_leaderboard_tournament_position", "compiled": true, "compiled_code": "\n\nWITH cte_leaderboard_round AS\n  (\n   SELECT\n        DISTINCT PlayerRoundID\n       ,RoundNumber\n       ,BackNineStart\n       ,PlayerID\n       ,TournamentID\n       ,PlayerTournamentID\n   FROM `personal-pgatour`.`tournament_leaderboard`.`leaderboard_round_stats`\n  )\n,\ncte_leaderboard_hole AS\n  (\n   SELECT\n       DISTINCT PlayerRoundID\n      ,HoleNumber\n      ,Par\n      ,ToPar\n      ,Strokes\n      ,ToParOnRound\n      ,StrokesOnRound\n   FROM `personal-pgatour`.`tournament_leaderboard`.`leaderboard_hole_stats`\n  )\n,\ncte_leaderboard_tournament AS\n  (\n   SELECT\n        rnd.PlayerRoundID\n       ,rnd.RoundNumber\n       ,hole.HoleNumber\n       ,hole.Par\n       ,hole.ToPar\n       ,hole.Strokes\n       ,hole.ToParOnRound\n       ,hole.StrokesOnRound\n       ,rnd.BackNineStart\n       ,rnd.PlayerID\n       ,rnd.TournamentID\n       ,rnd.PlayerTournamentID\n       ,SUM(ToPar) OVER (\n           PARTITION BY rnd.PlayerTournamentID\n           ORDER BY rnd.RoundNumber, hole.HoleNumber\n           ) AS ToParOnTournament\n       ,SUM(Strokes) OVER (\n           PARTITION BY rnd.PlayerTournamentID\n           ORDER BY  rnd.RoundNumber, hole.HoleNumber ASC\n           ) AS StrokesOnTournament\n   FROM cte_leaderboard_round  rnd\n   JOIN cte_leaderboard_hole   hole\n   ON  rnd.PlayerRoundID = hole.PlayerRoundID\n  )\n\nSELECT\n     trny.PlayerRoundID\n    ,trny.RoundNumber\n    ,trny.HoleNumber\n    ,trny.Par\n    ,trny.ToPar\n    ,trny.Strokes\n    ,trny.ToParOnRound\n    ,trny.StrokesOnRound\n    ,trny.ToParOnTournament\n    ,trny.StrokesOnTournament\n    ,trny.BackNineStart\n    ,trny.PlayerID\n    ,trny.TournamentID\n    ,trny.PlayerTournamentID\n    ,RANK() OVER (\n        PARTITION BY trny.TournamentID, trny.RoundNumber, trny.HoleNumber\n        ORDER BY trny.ToParOnTournament ASC\n        ) AS LeaderboardPositionOnTournament_ToPar\n    ,RANK() OVER (\n        PARTITION BY trny.TournamentID, trny.RoundNumber, trny.HoleNumber\n        ORDER BY trny.StrokesOnTournament ASC\n        ) AS LeaderboardPositionOnTournament_Strokes\nFROM cte_leaderboard_tournament  trny\n\nORDER BY\n     trny.TournamentID\n    ,trny.PlayerTournamentID\n    ,trny.RoundNumber\n    ,trny.HoleNumber", "relation_name": "`personal-pgatour`.`tournament_leaderboard`.`tournament_leaderboard_tournament_position`"}], "elapsed_time": 3.481879711151123, "args": {"log_format": "default", "log_level": "info", "project_dir": "/Users/reardonfamily/Desktop/kylewreardon_dataportfolio/pgatour/dbt_pgatour", "exclude": [], "write_json": true, "quiet": false, "partial_parse_file_diff": true, "which": "run", "warn_error_options": {"include": [], "exclude": []}, "log_level_file": "debug", "macro_debugging": false, "version_check": true, "cache_selected_only": false, "send_anonymous_usage_stats": true, "use_colors_file": true, "populate_cache": true, "enable_legacy_logger": false, "vars": {}, "strict_mode": false, "invocation_command": "dbt run", "select": [], "printer_width": 80, "favor_state": false, "indirect_selection": "eager", "profiles_dir": "/Users/reardonfamily/.dbt", "static_parser": true, "use_colors": true, "log_file_max_bytes": 10485760, "partial_parse": true, "log_path": "/Users/reardonfamily/Desktop/kylewreardon_dataportfolio/pgatour/dbt_pgatour/logs", "print": true, "defer": false, "log_format_file": "debug", "introspect": true, "show_resource_report": false}}